// https://adventofcode.com/2024/day/6

function parseMap(mapString) {
    return mapString.trim().split("\n").map(line => line.trim());
}

function simulateGuard(mapString) {
    const map = parseMap(mapString);

    const directions = ["^", ">", "v", "<"]; 
    const moves = [
        [-1, 0],  // Up
        [0, 1],   // Right
        [1, 0],   // Down
        [0, -1]   // Left
    ];

    let rows = map.length;
    let cols = map[0].length;

    // initial position
    let guardX, guardY, facing;
    for (let i = 0; i < rows; i++) {
        for (let j = 0; j < cols; j++) {
            if (directions.includes(map[i][j])) {
                guardX = i;
                guardY = j;
                facing = directions.indexOf(map[i][j]);
                break;
            }
        }
        if (guardX !== undefined) break;
    }

    let visited = new Set();
    visited.add(`${guardX},${guardY}`);

    while (true) {
        let [dx, dy] = moves[facing];
        let nx = guardX + dx;
        let ny = guardY + dy;

        // bounds
        if (nx < 0 || ny < 0 || nx >= rows || ny >= cols) break;

        if (map[nx][ny] === "#") {
            facing = (facing + 1) % 4;
        } else {
            // move
            guardX = nx;
            guardY = ny;
            visited.add(`${guardX},${guardY}`);
        }
    }

    return visited.size;
}

const mapString = `..#.........#...#......#...........#.#...#............#...#.........#....#......................#......#..........................
...........#....#.............#.....................................#............................................#.....#..........
.................#.........#.......#.......#..#............#.........#.........#............................................#.....
......#................................#.........................................#................................................
#...............................##......#.#...........................#....................#...#...............#.................#
.............#......#...........................................#..............#..........#..............#........................
...#...................#..............#........#.......#..........#.........................#.#.....#.....#.......................
#.#...#.............................#.................................................#..............#............#...............
.............................#.......#.............#......#...............#.....#.................................................
....................................#.....................................#.................#........#..........#.#..#...........#
......................#......#...............................#.................#.......#......................#.......#...........
...#..............#....................#............#...........##..#.....................................................#.......
....#.........#...................................#................................................#..........................#...
..............#.....#.................................................................#..#.....##.......#.........................
.........#....#...........##..........................................#......#.....................#..........#.......#...........
..#....#..........#.................................................................#....#............#............#........#.....
............#.#....#...........#.............#...........#..................#.....#.................................#.......#.....
..........#.......#............................#........#...........#.......#...#....#........#.............##.#............#.....
...................#.........#....#.....................................................................#.#..........#............
.#...#.#..................#...............................................#...........................#......................#....
.........#..............#.........#.......#.#......##..................#......#...#..#...........#.....................#..........
...............................#.............#..#......#............#..........#......................#..........#.............#..
..........#.....#..........................#..................................................#.#..#.....#........................
............#..##.................................#....................#.....#.......................................#............
......................#.#...................#......#..............................................................#...............
.......#.............................................................................#............................................
........#.................#....................................................#.......................................#....##.#..
..................#........................#......#..##....#.........#...##..#....................................#...............
.............#..............................................................................##...#......#.................#.......
..................................#.#.............................................................................#...............
...........#.................................#.......................................................................#......#.....
.....#............................................................#................................................#..............
.....#...........#.#..........#..............#..........................#.................................................#.......
....#........#...#..........#..#..........................................................................#.......................
.........................................................................#.....#.......................................#....#.....
...............#...#..#.....#.......................#.................#........#..........##....................................#.
.......................#....#...#..................#..................#.....................................#.............#.......
...........#..#...#..............................................^........#........................#......................#.......
.............................................#.................................................................................#..
......#...#.........#.....................................#...............................................#..#....#.......#.......
...#......................................................#.................#..#.............................................#....
.....#......................#.......................................#.............................................#....#..........
...#.....................................................#......#...#.......#....#..............................#....#............
......#.....#.....#...........#...#................#...........................................#..................................
...................................#...............#......................................................#.......................
..............................#...#........................................................#.#.............#......................
......#.......#............#..#......................#..#.....#..................#......#.........................................
#......#....#.......#....................#.....#.#............................................................................#...
.#....#...................................#.................#....................#........................................#.......
............................................#...................................#.......#..............#.........................#
............##.........#..............................................................................#.........#.................
##.................................................#.......................#.#.....#..............................................
...........................#..........#...#.#.........................#.................................##.....#..................
.............#..........#........................................#............#............#.....................................#
.....................................................#.................................................#..........................
.....#........................................#.............................#...#.....................#...........................
.......#..................................#...........#.......#.....#........................................#.......#............
.............#.......................#......................#.....#.......#..................................#..#........#........
.......................................................#......#...............#.........#.............#............#..............
....#...............................#.#.....................#.................................................................#..#
...........................#........#..........................................#........................................#.........
....#.............................................................................................................................
.##........#.......#..................#.#....#.............................................................#.##...................
.#..#.......................##........................................................#...............................#...........
.....#.#..............#...........................................#...............................................................
.....#.#............................#.............................................................................................
......................#............................#....#............................................................#............
.......#.......................................................................#..................#...##..........................
...............#...................................................#.....................................#...............#.#......
....#..........#.......#..#................................#......................................................................
#......##..................................................................#...#........................#.........................
..................................#........................................................................#...........#......#...
.#....................#....#..................................#..#..................#.#.......................#...................
......#..#................................................................................................##......................
.....##........#..#.......................#.........#............#....#...........................................................
...............#...........#.................#...........#.........#.......................#.........#........................#...
............................................................................................#..#..................................
..........................................#.............#..#...............#.............................#.#......#.............#.
......................#............#..........#............................................................#...#................#.
...........#...................#..................................................................................................
.......#........................#.................................................................#.................#.............
#...##................#......................................................................#................................#...
...#.....#.......................#...#..............#....................#.........#.........#....................................
....#.....................................#.............................................................................#.........
.........#..............................................................................#..............#..........................
...................................#.#...............#........................................................................##..
.........#............#..............#..........................................................................#...#.............
.....#.......................#..#....#.#....................#..........................................#..........................
.......................................#........#.........#.....................#.............#...........#...............#.......
................#.................................................................................................................
.......#....................................#..................#...........#.....#.........................#......................
...................#................................................................#...............#................#............
..........#.......................#......................#...........#..#........#....#.........................#.................
...................#........................#.......#................................................#............................
.......................#......................................................#...........#.......#...................#...........
........#..........#........#......#......................#......................................#...............#................
...........................................................#...#..................................................................
.......................#......................#............#..#....#...#............................#.............................
.#.#...............#..........#..........##........#..............................................................................
##.........#....................#...................#.........#......................##..................#...............#........
.#......................#...#...#......................#............#......................#.................#..................#.
#..............................#......................................#.........#.#...............................................
...........#....#......#.......#..........................#..........................................#......#............#..#.....
................................................................................................#.......#.........................
....#..................................#..........................#.................................#...#...#.....................
.......................#.#..#.............................#.#...........................#......#..........#.......................
...##.......................................#..................#....................#.............................................
...#.......#........................#..........##.....#............#......................#.....................................#.
......#..............#.............................#.............................................#.............................#..
#...........................................#.......#....#.#..........#........#............#.......................#.......#.....
..................#.......#............#.....#.............................................................#......................
.#.....................................................................................#...................................#......
...........#.........#.#.................#..........................#............................................#.......##.......
.......................#......#.................................................#........................#.................#......
..................#........................................................#................................................#....#
...............................#.......#....#.........#..........#.....#.......................................#..#...............
......##................##...#....#...#...#............................................................................#..........
.......................#............#...................................#....#.......#.............................#..............
..............................#.........................................................#........#.............#..................
........................#............................................#..................#.....#...................#...............
............#......#...............................#.............................................................................#
.#.........#.........#.........#.......#.#..#...#...............................#.......#.........#..........................#....
........................#.................................................#....................................##......#..........
....#.......#.....................##...#..........................................................................................
.................................#.......................................#.......................#.#......#.......................
.#.............#..................#...........................#.................#...........................................#.....
.....#.........#................#..........#..#..........#......................#...#......................#....#.................
.................#......#.....................................................................#...................................
......................#.......................................................#..#......#..............#..#..#..........#.........
...............................#.........#........#..................#.#.........#.#.#........#..#.........#....##...#............`;

console.log("Distinct positions visited:", simulateGuard(mapString));